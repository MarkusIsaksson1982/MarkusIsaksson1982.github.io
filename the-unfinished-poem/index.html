<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>The Unfinished Poem</title>
<style>
  body { margin:0; background:#000; height:100vh; display:flex; justify-content:center; align-items:center; color:#aaa; font-family:monospace; }
  #poem { width:700px; height:400px; padding:20px; border:2px solid #333; background:#111; overflow:hidden; }
  #info { position:absolute; top:10px; left:10px; color:#444; font-size:12px; }
</style>
</head>
<body>
<div id="poem"></div>
<div id="info">Type to guide the poem. Stop for 60s â†’ it forgets and starts anew.</div>

<script>
const poemDiv = document.getElementById('poem');
let lines = [
  "In the quiet dark, a whisper lingers...",
  "Shadows remember what light forgot.",
  "We are echoes of moments that never were."
];
let currentLine = 0;
let charIndex = 0;
let lastKeyTime = Date.now();
let direction = 1;
let tone = 'melancholy';

function type() {
  if (charIndex < lines[currentLine].length) {
    poemDiv.innerHTML += lines[currentLine][charIndex];
    charIndex++;
    setTimeout(type, 50);
  } else {
    poemDiv.innerHTML += '<br>';
    currentLine++;
    charIndex = 0;
    if (currentLine >= lines.length) {
      currentLine = 0;
      direction *= -1;
      tone = tone === 'melancholy' ? 'hopeful' : 'melancholy';
    }
    setTimeout(type, 800);
  }
}

document.addEventListener('keydown', () => {
  lastKeyTime = Date.now();
  // Change direction or tone on keypress
  if (Math.random() < 0.3) {
    direction *= -1;
    lines[currentLine] = lines[currentLine].split('').reverse().join('');
  }
});

function checkInactivity() {
  if (Date.now() - lastKeyTime > 60000) {
    poemDiv.innerHTML = '';
    currentLine = 0;
    charIndex = 0;
    lines.push(`And so it fades, sadder than before...`);
    lastKeyTime = Date.now();
  }
  requestAnimationFrame(checkInactivity);
}

type();
checkInactivity();
</script>
</body>
</html>
