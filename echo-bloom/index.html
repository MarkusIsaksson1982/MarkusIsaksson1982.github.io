<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Echo Bloom</title>
<style>
  body { margin:0; background:#000; height:100vh; display:flex; justify-content:center; align-items:center; }
  canvas { image-rendering: pixelated; }
  #info { position:absolute; top:10px; left:10px; color:#444; font-family:monospace; font-size:12px; }
</style>
</head>
<body>
<canvas id="c" width="900" height="600"></canvas>
<div id="info">Move the mouse to sway the flower. Click to plant glowing echoes that fade into fractal veins.</div>

<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
let mouseX = canvas.width / 2;
let mouseY = canvas.height / 2;
let prevMouseX = mouseX;
let prevMouseY = mouseY;
const echoes = []; // glowing echoes

function drawFlower() {
  const cx = canvas.width / 2;
  const cy = canvas.height / 2;
  const sway = Math.sin(Date.now() * 0.001 + mouseX * 0.01) * 20;
  const size = 180 + Math.abs(mouseX - cx) / 10;

  ctx.fillStyle = '#000';
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Petals (symmetric)
  for (let i = 0; i < 8; i++) {
    const angle = i * Math.PI / 4 + sway;
    const x = cx + Math.cos(angle) * size;
    const y = cy + Math.sin(angle) * size;
    ctx.beginPath();
    ctx.arc(x, y, 60, 0, Math.PI * 2);
    ctx.fillStyle = `hsl(${Date.now() * 0.05 % 360}, 90%, 70%)`;
    ctx.fill();
  }

  // Golden center
  ctx.beginPath();
  ctx.arc(cx, cy, 80, 0, Math.PI * 2);
  ctx.fillStyle = 'gold';
  ctx.fill();
}

function createEcho() {
  echoes.push({
    x: mouseX,
    y: mouseY,
    age: 0,
    branches: []
  });
}

function drawEchoes() {
  echoes.forEach(e => {
    e.age += 0.8;
    if (e.age > 300) return;

    const alpha = 1 - e.age / 300;
    const size = 40 * alpha;

    // Fractal veins
    if (e.age % 30 === 0 && e.branches.length < 8) {
      e.branches.push({ angle: Math.random() * Math.PI * 2, length: 40 });
    }

    e.branches.forEach(b => {
      const endX = e.x + Math.cos(b.angle) * b.length * alpha;
      const endY = e.y + Math.sin(b.angle) * b.length * alpha;
      ctx.strokeStyle = `rgba(255,215,0,${alpha * 0.6})`;
      ctx.lineWidth = 3 * alpha;
      ctx.beginPath();
      ctx.moveTo(e.x, e.y);
      ctx.lineTo(endX, endY);
      ctx.stroke();
    });

    // Glow
    ctx.globalAlpha = alpha * 0.4;
    ctx.fillStyle = 'gold';
    ctx.beginPath();
    ctx.arc(e.x, e.y, size, 0, Math.PI * 2);
    ctx.fill();
  });
  ctx.globalAlpha = 1;

  // Clean up old echoes
  if (echoes.length > 20) echoes.shift();
}

function animate() {
  prevMouseX = mouseX;
  prevMouseY = mouseY;
  drawFlower();
  drawEchoes();
  requestAnimationFrame(animate);
}

canvas.addEventListener('mousemove', e => {
  mouseX = e.clientX;
  mouseY = e.clientY;
});

canvas.addEventListener('click', () => createEcho());

animate();
</script>
</body>
</html>
