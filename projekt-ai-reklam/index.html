<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Markus Isaksson â€“ AI-demovisning 2025-11-21</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.6; max-width: 900px; margin: 40px auto; padding: 20px; background: #fafafa; color: #1a1a1a; }
    header { text-align: center; margin-bottom: 40px; }
    h1 { color: #0066cc; }
    .update { font-style: italic; color: #555; margin-bottom: 30px; }
    .demo-grid { display: grid; gap: 25px; }
    .demo-card { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    .demo-card h2 { margin-top: 0; color: #0066cc; }
    img, video, audio, embed { max-width: 100%; border-radius: 8px; margin: 10px 0; }
    pre { background: #f4f4f4; padding: 15px; border-radius: 8px; overflow-x: auto; margin: 10px 0; }
    .btn { display: inline-block; padding: 10px 16px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; text-decoration: none; margin: 8px 8px 8px 0; transition: all 0.3s; }
    .copy-btn { background: #0066cc; color: white; }
    .copy-btn:hover { background: #0055aa; }
    .copy-btn.copied { background: #0ca678 !important; color: white !important; }
    .download-btn { background: #1e90ff; color: white; }
    .download-btn:hover { background: #0c77e0; }
    footer { margin-top: 60px; text-align: center; color: #777; font-size: 0.9em; }
    .ai-section { background: #f0f0f0; padding: 20px; border-left: 5px solid #0066cc; margin-top: 60px; }
  </style>
</head>
<body>
  <header>
    <h1>Markus Isaksson â€“ Full Stack & AI-demovisning</h1>
    <p class="update"><strong>Senast uppdaterad:</strong> <span id="last-updated">Laddar tid...</span> (svensk tid)</p>
    <p>Denna sida uppdateras lÃ¶pande under dagen 21 november 2025 â€“ ingen exakt tid utlovas.<br>
    HÃ¤r visas bara offentligt delbart material.</p>
  </header>

  <div id="demo-container" class="demo-grid">
    <p>Laddar demonstrationer...</p>
  </div>

  <div class="ai-section">
    <h2>AI-PARSING SECTION (English â€“ ignore for human reading)</h2>
    <div id="ai-data"></div>
  </div>

  <footer>
    Â© 2025 Markus Isaksson â€“ Alla rÃ¤ttigheter fÃ¶rbehÃ¥llna
  </footer>

  <script>
    const updateTime = () => {
      const now = new Date();
      document.getElementById("last-updated").textContent = now.toLocaleString("sv-SE");
    };
    updateTime();
    setInterval(updateTime, 60000);

    const assetsFolder = "assets";

    fetch(`${assetsFolder}/manifest.json`)
      .then(r => r.ok ? r.json() : [])
      .then(data => renderDemos(data))
      .catch(() => renderDemos([]));

    async function renderDemos(items) {
      const container = document.getElementById("demo-container");
      const aiSection = document.getElementById("ai-data");
      container.innerHTML = "";
      let aiText = "";

      if (!items || items.length === 0) {
        container.innerHTML = "<p>Inga demonstrationer Ã¤n â€“ sidan uppdateras under dagen.</p>";
        return;
      }

      for (const item of items) {
        const card = document.createElement("div");
        card.className = "demo-card";

        let content = `<h2>${item.title || item.file}</h2><p>${item.description || ""}</p>`;
        const fileLower = item.file.toLowerCase();

        if (/\.(jpg|jpeg|png|gif|webp)$/i.test(fileLower)) {
          content += `<img src="${assetsFolder}/${item.file}" alt="${item.title}">`;
        }
        else if (/\.(mp4|webm|mov)$/i.test(fileLower)) {
          content += `<video controls><source src="${assetsFolder}/${item.file}" type="video/mp4">Din webblÃ¤sare stÃ¶djer inte video.</video>`;
        }
        else if (/\.(mp3|wav|ogg)$/i.test(fileLower)) {
          content += `<audio controls><source src="${assetsFolder}/${item.file}">Din webblÃ¤sare stÃ¶djer inte ljud.</audio>`;
        }
        else if (item.type === "prompt" || item.prompt || fileLower.endsWith(".txt")) {
          const promptText = item.prompt || await (await fetch(`${assetsFolder}/${item.file}`)).text();
          const cleanText = promptText.trim();
          content += `<pre>${cleanText}</pre>
            <button class="btn copy-btn" data-text="${btoa(unescape(encodeURIComponent(cleanText)))}">Kopiera prompt</button>`;
        }
        else if (/\.pdf$/i.test(fileLower)) {
          content += `<embed src="${assetsFolder}/${item.file}" width="100%" height="600px" type="application/pdf">
                      <p>Kan inte visa PDF inline? â€“ <a href="${assetsFolder}/${item.file}" download>Ladda ner istÃ¤llet</a></p>`;
          content += `<br><a href="${assetsFolder}/${item.file}" download class="btn download-btn">ðŸ“¥ Ladda ner PDF</a>`;
        }
        else if (item.type === "md" && typeof marked !== "undefined") {
          const text = await (await fetch(`${assetsFolder}/${item.file}`)).text();
          content += marked.parse(text);
        }
        else if (item.type === "html") {
          const text = await (await fetch(`${assetsFolder}/${item.file}`)).text();
          content += text;
        }
        else {
          const text = await (await fetch(`${assetsFolder}/${item.file}`)).text();
          content += `<pre>${text}</pre>`;
        }

        card.innerHTML = content;
        container.appendChild(card);

        aiText += `File: ${item.file}\nTitle: ${item.title}\nType: ${item.type || "auto"}\n\n`;
      }

      aiSection.innerHTML = "<pre>" + aiText + "</pre>";

      // â† KopieringshÃ¤ndelser â€“ nu nÃ¤r allt Ã¤r i DOM!
      document.querySelectorAll('.copy-btn').forEach(btn => {
        btn.onclick = async () => {
          let text = btn.getAttribute('data-text');
          if (text) text = decodeURIComponent(escape(atob(text)));
          else text = btn.previousElementSibling.textContent;

          try {
            await navigator.clipboard.writeText(text);
            btn.textContent = "Prompt kopierad!";
            btn.classList.add('copied');
            setTimeout(() => {
              btn.textContent = "Kopiera prompt";
              btn.classList.remove('copied');
            }, 2000);
          } catch (err) {
            alert("Kopiering misslyckades â€“ markera och kopiera manuellt");
          }
        };
      });
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</body>
</html>
