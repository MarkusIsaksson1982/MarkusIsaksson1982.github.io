<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Gravity Ghosts – Temporal Resonance</title>
<style>
  body { margin:0; background:#000; display:flex; justify-content:center; align-items:center; height:100vh; }
  canvas { border:4px solid #333; image-rendering:pixelated; }
</style>
</head>
<body>
<canvas id="c" width="900" height="600"></canvas>

<script>
// ==== Gravity Ghosts – single-file, vanilla, working prototype ====
// Core mechanic: Temporal Resonance – colliding gravitons share "memories" (past positions) that linger as colored trails

const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const players = [];           // all gravitons
const trails = [];            // resonance memories
let myId = 0;

class Graviton {
  constructor(id, x, y, color) {
    this.id = id;
    this.x = x;
    this.y = y;
    this.vx = (Math.random()-0.5)*4;
    this.vy = (Math.random()-0.5)*4;
    this.color = color;
    this.trail = [];           // past positions for resonance effect
  }
  update() {
    this.x += this.vx;
    this.y += this.vy;
    if (this.x < 0 || this.x > canvas.width) this.vx *= -1;
    if (this.y < 0 || this.y > canvas.height) this.vy *= -1;
    this.x = Math.max(0, Math.min(canvas.width, this.x));
    this.y = Math.max(0, Math.min(canvas.height, this.y));

    // leave memory trail
    this.trail.push({x:this.x, y:this.y, age:0});
    if (this.trail.length > 40) this.trail.shift();
    this.trail.forEach(p => p.age++);
  }
  draw() {
    // trail (temporal resonance)
    this.trail.forEach((p,i) => {
      const alpha = 1 - p.age/40;
      ctx.fillStyle = `rgba(${this.color},${alpha*0.4})`;
      ctx.fillRect(p.x-3, p.y-3, 6, 6);
    });
    // graviton itself
    ctx.fillStyle = `rgb(${this.color})`;
    ctx.beginPath();
    ctx.arc(this.x, this.y, 12, 0, Math.PI*2);
    ctx.fill();
    ctx.strokeStyle = "#fff";
    ctx.lineWidth = 2;
    ctx.stroke();
  }
}

// create 6 AI + 1 player
function init() {
  const colors = ["255,100,100", "100,255,100", "100,100,255", "255,255,100", "255,100,255", "100,255,255"];
  for (let i = 0; i < 7; i++) {
    const p = new Graviton(i,
      Math.random()*canvas.width,
      Math.random()*canvas.height,
      i===0 ? "255,220,100" : colors[i-1||0]
    );
    if (i===0) myId = 0;
    players.push(p);
  }
}

// simple circle collision → resonance (share trail colors)
function checkCollisions() {
  for (let i = 0; i < players.length; i++) {
    for (let j = i+1; j < players.length; j++) {
      const a = players[i], b = players[j];
      const dx = a.x - b.x;
      const dy = a.y - b.y;
      if (dx*dx + dy*dy < 50*50) {
        // swap a chunk of trail colors → visual "memory share"
        const tmp = a.color;
        a.color = b.color;
        b.color = tmp;
        // create burst of shared memories
        for (let k = 0; k < 15; k++) {
          trails.push({
            x: (a.x + b.x)/2,
            y: (a.y + b.y)/2,
            age: Math.random()*30
          });
        }
      }
    }
  }
}

// input – control player 0
const keys = {};
window.onkeydown = e => keys[e.key.toLowerCase()] = true;
window.onkeyup = e => keys[e.key.toLowerCase()] = false;

function handleInput() {
  const p = players[0];
  if (!p) return;
  const speed = 0.4;
  if (keys['w']) p.vy -= speed;
  if (keys['s']) p.vy += speed;
  if (keys['a']) p.vx -= speed;
  if (keys['d']) p.vx += speed;
}

// main loop
function loop() {
  ctx.fillStyle = "#000";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  handleInput();
  players.forEach(p => p.update());
  checkCollisions();

  // fade old shared memories
  for (let i = trails.length-1; i >= 0; i--) {
    trails[i].age++;
    if (trails[i].age > 60) trails.splice(i,1);
    else {
      ctx.fillStyle = `rgba(255,255,255,${1-trails[i].age/60})`;
      ctx.fillRect(trails[i].x-2, trails[i].y-2, 4, 4);
    }
  }

  players.forEach(p => p.draw());

  requestAnimationFrame(loop);
}

init();
loop();
</script>

<div style="position:absolute; top:10px; left:10px; color:#888; font-family:monospace;">
Gravity Ghosts – WASD to move your golden graviton<br>
Collide → steal memories → watch the colors (and past positions) mix
</div>
</body>
</html>
