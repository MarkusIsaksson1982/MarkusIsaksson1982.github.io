<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<pre style="white-space: pre-wrap; font-family: sans-serif;">
---
Type: Code artifact generated by Grok 4 
Author: Grok 4
File name(s): (snippets)
Keywords: [not added yet]
---

// New variables
let currentProfile = '';
const HIGHSCORES_KEY = 'nyhetskoll_highscores';

// In generateQuiz(), call populateProfiles();
function populateProfiles() {
  const select = document.getElementById('profile-select');
  select.innerHTML = '<option value="">-- Välj --</option><option value="new">Ny användare</option>';
  const savedProfiles = Object.keys(localStorage).filter(k => k.startsWith('nyhetskoll_quiz_state_')).map(k => k.replace('nyhetskoll_quiz_state_', ''));
  savedProfiles.forEach(p => {
    const opt = document.createElement('option');
    opt.value = p;
    opt.text = p;
    select.add(opt);
  });
}

// In switchProfile()
function switchProfile() {
  const select = document.getElementById('profile-select');
  const newProfile = select.value;
  if (newProfile === 'new') return createNewProfile();
  if (currentProfile) saveState(); // Save old
  currentProfile = newProfile;
  loadStateFromStorage(); // Load new
}

// New createNewProfile()
function createNewProfile() {
  const name = prompt('Ange ditt namn:');
  if (name) {
    currentProfile = name;
    populateProfiles();
    document.getElementById('profile-select').value = name;
    resetQuiz(); // Start fresh
  }
}

// Update STORAGE_KEY to dynamic: const STORAGE_KEY = `nyhetskoll_quiz_state_${currentProfile}`;

// In submitQuiz(), after score calc
const highscores = JSON.parse(localStorage.getItem(HIGHSCORES_KEY) || '[]');
highscores.push({name: currentProfile, score, date: new Date().toISOString()});
highscores.sort((a,b) => b.score - a.score);
localStorage.setItem(HIGHSCORES_KEY, JSON.stringify(highscores.slice(0,10))); // Keep top 10
showLeaderboard();

// New showLeaderboard()
function showLeaderboard() {
  const highscores = JSON.parse(localStorage.getItem(HIGHSCORES_KEY) || '[]');
  const div = document.getElementById('leaderboard');
  div.innerHTML = '<h3>Leaderboard (Top 5)</h3><ul>' + highscores.slice(0,5).map(h => `<li>${h.name}: ${h.score} poäng (${h.date.split('T')[0]})</li>`).join('') + '</ul>';
}

// New clearLeaderboard()
function clearLeaderboard() {
  if (confirm('Rensa leaderboard?')) localStorage.removeItem(HIGHSCORES_KEY); showLeaderboard();
}

// Call populateProfiles() and showLeaderboard() on load
populateProfiles();
showLeaderboard();

// In loadQuiz(), resetQuiz() to clear current state, but keep leaderboard  
</pre>

</body>
</html>
