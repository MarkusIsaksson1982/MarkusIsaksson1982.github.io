<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<pre style="white-space: pre-wrap; font-family: sans-serif;">
---
Type: Code artifact generated by Claude Sonnet 4 
Author: Claude Sonnet 4
File name(s): integrated_platform.jsx
Keywords: [not added yet]
---

<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nyhetskoll Quiz & Transcript Evaluator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: start;
        }

        .quiz-section, .transcript-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .section-title {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.8rem;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            width: 0%;
            transition: width 0.3s ease;
        }

        .question {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .question.answered {
            border-color: #3498db;
            background: rgba(52, 152, 219, 0.05);
        }

        .question-number {
            color: #3498db;
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 10px;
        }

        .question-text {
            font-weight: 500;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .multiple-choice-indicator {
            background: #f39c12;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-bottom: 10px;
            display: inline-block;
        }

        .option {
            margin: 8px 0;
            display: flex;
            align-items: center;
        }

        .option input {
            margin-right: 10px;
            transform: scale(1.2);
        }

        .option label {
            cursor: pointer;
            flex-grow: 1;
            padding: 8px;
            border-radius: 5px;
            transition: background 0.2s ease;
        }

        .option label:hover {
            background: rgba(52, 152, 219, 0.1);
        }

        .transcript-area {
            width: 100%;
            height: 300px;
            padding: 15px;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            font-family: monospace;
            font-size: 14px;
            resize: vertical;
            margin-bottom: 20px;
        }

        .transcript-area:focus {
            border-color: #3498db;
            outline: none;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .btn-success {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }

        .btn-success:hover {
            box-shadow: 0 6px 20px rgba(46, 204, 113, 0.4);
        }

        .results {
            margin-top: 30px;
            padding: 20px;
            background: rgba(46, 204, 113, 0.1);
            border: 2px solid #2ecc71;
            border-radius: 10px;
            display: none;
        }

        .results.show {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .score {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2ecc71;
            margin-bottom: 15px;
        }

        .transcript-matches {
            margin-top: 20px;
        }

        .match-result {
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(52, 152, 219, 0.05);
            border-left: 4px solid #3498db;
            border-radius: 5px;
        }

        .match-question {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .match-text {
            color: #7f8c8d;
            font-style: italic;
        }

        .highlighted-match {
            background: yellow;
            padding: 2px 4px;
            border-radius: 3px;
        }

        .no-matches {
            color: #e74c3c;
            font-style: italic;
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            cursor: pointer;
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            box-shadow: 0 4px 15px rgba(155, 89, 182, 0.3);
            transition: all 0.3s ease;
        }

        .file-input-wrapper:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(155, 89, 182, 0.4);
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #3498db;
        }

        .stat-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üì∫ Nyhetskoll Quiz & Transcript Evaluator</h1>
            <p>Utv√§rdera nyhetsprogram med interaktiva quiz och transkriptanalys</p>
        </div>

        <div class="main-content">
            <div class="quiz-section">
                <h2 class="section-title">üìù Quiz</h2>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>

                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="answeredCount">0</div>
                        <div class="stat-label">Besvarade</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="totalCount">0</div>
                        <div class="stat-label">Totalt</div>
                    </div>
                </div>

                <div id="quizContainer"></div>

                <div class="controls">
                    <button class="btn btn-success" onclick="submitQuiz()">üìä R√§tta Quiz</button>
                    <button class="btn" onclick="resetQuiz()">üîÑ B√∂rja Om</button>
                    <div class="file-input-wrapper">
                        üìÅ Ladda Nytt Quiz
                        <input type="file" id="quizFileInput" accept=".json,.txt" onchange="loadNewQuiz(this)">
                    </div>
                </div>

                <div id="results" class="results"></div>
            </div>

            <div class="transcript-section">
                <h2 class="section-title">üìÑ Transkript & Analys</h2>
                
                <textarea 
                    id="transcriptArea" 
                    class="transcript-area" 
                    placeholder="Klistra in transkriptet fr√•n nyhetsprogrammet h√§r...&#10;&#10;Detta anv√§nds f√∂r att:&#10;‚Ä¢ S√∂ka efter nyckelord fr√•n quizfr√•gorna&#10;‚Ä¢ Verifiera att √§mnen t√§cks i programmet&#10;‚Ä¢ Ge ledtr√•dar f√∂r quiz-svar&#10;‚Ä¢ Analysera programinneh√•llet"></textarea>

                <div class="controls">
                    <button class="btn" onclick="analyzeTranscript()">üîç Analysera Transkript</button>
                    <button class="btn" onclick="highlightMatches()">‚ú® Markera Matchningar</button>
                    <button class="btn" onclick="clearTranscript()">üóëÔ∏è Rensa</button>
                </div>

                <div id="transcriptMatches" class="transcript-matches"></div>
            </div>
        </div>
    </div>

    <script>
        // Quiz data from the PDF
        let currentQuiz = [
            {
                "number": "1",
                "text": "Vad heter h√∂gerdebatt√∂ren som sk√∂ts till d√∂ds f√∂rra veckan?",
                "options": {
                    "A": "Tyler Robinson",
                    "B": "Charlie Kirk", 
                    "C": "Tucker Carlson"
                },
                "is_multiple": false,
                "correct": ["B"]
            },
            {
                "number": "2",
                "text": "Vapenlagarna i USA st√•r i the second amendment som finns i The Bill of Rights, som i sin tur √§r ett till√§gg till konstitutionen. Vad √§r konstitutionen?",
                "options": {
                    "A": "riksdagen",
                    "B": "grundlagen",
                    "C": "senaten"
                },
                "is_multiple": false,
                "correct": ["B"]
            },
            {
                "number": "3",
                "text": "Vad visar en ny brasiliansk studie om s√∂tningsmedel och vad s√§ger Livsmedelsverket om det h√§r?",
                "options": {
                    "A": "Studien visar att det inte g√•r att dra n√•gra slutsatser av studien, men att allt tyder p√• att man inte beh√∂ver vara orolig. Livsmedelsverket s√§ger d√§remot att s√∂tningsmedel kan f√∂rs√§mra hj√§rnans f√∂rm√•ga att ta emot och bearbeta information.",
                    "B": "Studien visar att s√∂tningsmedel kan f√∂rs√§mra hj√§rnans f√∂rm√•ga att ta emot och bearbeta information. Livsmedelsverket s√§ger d√§remot att fler studier beh√∂vs och att man inte beh√∂ver vara orolig.",
                    "C": "B√•de studien och Livsmedelsverket v√§ger att s√∂tningsmedel kan f√∂rs√§mra hj√§rnans f√∂rm√•ga att ta emot och bearbeta information."
                },
                "is_multiple": false,
                "correct": ["B"]
            },
            {
                "number": "4",
                "text": "Regeringen har kommit med f√∂rslag p√• att polisen ska f√• anv√§nda hemliga tv√•ngsmedel mot barn under 15 √•r. Vilka alternativ nedan √§r exempel p√• hemliga tv√•ngsmedel? Alla alternativ som st√§mmer beh√∂ver v√§ljas f√∂r att f√• r√§tt p√• fr√•gan.",
                "options": {
                    "A": "fotboja",
                    "B": "avlyssning",
                    "C": "kamera√∂vervakning"
                },
                "is_multiple": true,
                "correct": ["B", "C"]
            },
            {
                "number": "5",
                "text": "Barn och unga kan f√• bidrag f√∂r att h√•lla p√• med fritidsaktiviteter inom kultur och idrott. Det kallas fritidskortet. Hur mycket pengar handlar det om?",
                "options": {
                    "A": "500 kronor i m√•naden",
                    "B": "500 kronor per √•r",
                    "C": "500 kronor per termin"
                },
                "is_multiple": false,
                "correct": ["B"]
            },
            {
                "number": "6",
                "text": "Vad visar en ny rapport fr√•n CAN, Centralf√∂rbundet f√∂r alkohol- och narkotikaupplysning?",
                "options": {
                    "A": "F√§rre unga knarkar.",
                    "B": "Det √§r mycket sv√•rare att f√• tag p√• narkotika idag.",
                    "C": "Fler personer under 30 √•r misst√§nks f√∂r narkotikabrott nu j√§mf√∂rt med innan pandemin."
                },
                "is_multiple": false,
                "correct": ["A"]
            },
            {
                "number": "7",
                "text": "Vad kr√§vs f√∂r att f√• r√∂sta i kyrkovalet nu p√• s√∂ndag? Alla alternativ som st√§mmer beh√∂ver v√§ljas f√∂r att f√• r√§tt p√• fr√•gan.",
                "options": {
                    "A": "Man √§r medlem i Svenska kyrkan.",
                    "B": "Man √§r svensk medborgare.",
                    "C": "Man √§r folkbokf√∂rd i Sverige.",
                    "D": "Man √§r myndig.",
                    "E": "Man har fyllt 16 √•r senast p√• valdagen."
                },
                "is_multiple": true,
                "correct": ["A", "C", "E"]
            },
            {
                "number": "8",
                "text": "Nu kommer en rapport som anklagar Israel f√∂r att beg√• folkmord i Gaza. Vem eller vilka st√•r bakom rapporten?",
                "options": {
                    "A": "L√§kare Utan Gr√§nser",
                    "B": "EU",
                    "C": "FN"
                },
                "is_multiple": false,
                "correct": ["C"]
            },
            {
                "number": "9",
                "text": "Vad √§r folkmord, enligt FN:s folkmordskonvention?",
                "options": {
                    "A": "Folkmord inneb√§r att minst en av fem handlingar beg√•s med avsikt att helt eller delvis f√∂rg√∂ra en grupp. Tv√• av handlingarna n√§mns i programmet; att d√∂da medlemmar av gruppen och att skapa levnadsf√∂rh√•llanden som g√∂r att personer d√∂r.",
                    "B": "Folkmord inneb√§r att fem av fem handlingar beg√•s med avsikt att helt eller delvis f√∂rg√∂ra en grupp. Tv√• av handlingarna n√§mns i programmet; att d√∂da medlemmar av gruppen och att skapa levnadsf√∂rh√•llanden som g√∂r att personer d√∂r."
                },
                "is_multiple": false,
                "correct": ["A"]
            },
            {
                "number": "10",
                "text": "Varf√∂r har Spanien, Irland, Nederl√§nderna, Slovenien och Island sagt att de inte kommer att vara med i Eurovision Song Contest 2026?",
                "options": {
                    "A": "Om kostnaden f√∂r att delta √∂kar f√∂r mycket.",
                    "B": "Om Israel till√•ts delta i t√§vlingen.",
                    "C": "Om Ryssland till√•ts delta i t√§vlingen."
                },
                "is_multiple": false,
                "correct": ["B"]
            },
            {
                "number": "11",
                "text": "Veckans program tog upp attacker mot civila d√§r √∂ver 50 personer d√∂dades i veckan. Vilket land g√§ller det?",
                "options": {
                    "A": "Haiti",
                    "B": "Dominikanska republiken",
                    "C": "Myanmar"
                },
                "is_multiple": false,
                "correct": ["A"]
            },
            {
                "number": "12",
                "text": "Stavhopparen Armand Duplantis slog v√§rldsrekord f√∂r 14:e g√•ngen i veckan. Hur h√∂gt hoppade han?",
                "options": {
                    "A": "5.30 meter",
                    "B": "6.30 meter",
                    "C": "7.30 meter"
                },
                "is_multiple": false,
                "correct": ["B"]
            }
        ];

        let userAnswers = {};
        let transcriptMatches = [];

        // Initialize the app
        function initializeApp() {
            renderQuiz();
            updateStats();
            updateProgress();
        }

        // Render quiz questions
        function renderQuiz() {
            const container = document.getElementById('quizContainer');
            container.innerHTML = '';

            currentQuiz.forEach(question => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.id = `question-${question.number}`;

                let optionsHTML = '';
                Object.entries(question.options).forEach(([key, value]) => {
                    const inputType = question.is_multiple ? 'checkbox' : 'radio';
                    const name = question.is_multiple ? `question-${question.number}` : `question-${question.number}`;
                    
                    optionsHTML += `
                        <div class="option">
                            <input type="${inputType}" 
                                   id="q${question.number}-${key}" 
                                   name="${name}" 
                                   value="${key}"
                                   onchange="handleAnswerChange(${question.number}, '${key}', this.checked, ${question.is_multiple})">
                            <label for="q${question.number}-${key}">${key}. ${value}</label>
                        </div>
                    `;
                });

                questionDiv.innerHTML = `
                    <div class="question-number">Fr√•ga ${question.number}</div>
                    ${question.is_multiple ? '<div class="multiple-choice-indicator">Flera svar m√∂jliga</div>' : ''}
                    <div class="question-text">${question.text}</div>
                    ${optionsHTML}
                `;

                container.appendChild(questionDiv);
            });
        }

        // Handle answer changes
        function handleAnswerChange(questionNumber, optionKey, isChecked, isMultiple) {
            if (!userAnswers[questionNumber]) {
                userAnswers[questionNumber] = [];
            }

            if (isMultiple) {
                if (isChecked) {
                    if (!userAnswers[questionNumber].includes(optionKey)) {
                        userAnswers[questionNumber].push(optionKey);
                    }
                } else {
                    userAnswers[questionNumber] = userAnswers[questionNumber].filter(key => key !== optionKey);
                }
            } else {
                userAnswers[questionNumber] = isChecked ? [optionKey] : [];
            }

            // Visual feedback
            const questionDiv = document.getElementById(`question-${questionNumber}`);
            if (userAnswers[questionNumber].length > 0) {
                questionDiv.classList.add('answered');
            } else {
                questionDiv.classList.remove('answered');
            }

            updateProgress();
            updateStats();
        }

        // Update progress bar
        function updateProgress() {
            const answeredQuestions = Object.keys(userAnswers).filter(q => userAnswers[q].length > 0).length;
            const totalQuestions = currentQuiz.length;
            const progress = (answeredQuestions / totalQuestions) * 100;
            
            document.getElementById('progressFill').style.width = `${progress}%`;
        }

        // Update statistics
        function updateStats() {
            const answeredQuestions = Object.keys(userAnswers).filter(q => userAnswers[q].length > 0).length;
            document.getElementById('answeredCount').textContent = answeredQuestions;
            document.getElementById('totalCount').textContent = currentQuiz.length;
        }

        // Submit and score quiz
        function submitQuiz() {
            let correctAnswers = 0;
            let totalQuestions = currentQuiz.length;
            let resultDetails = [];

            currentQuiz.forEach(question => {
                const userAnswer = userAnswers[question.number] || [];
                const correctAnswer = question.correct;
                
                const isCorrect = userAnswer.length === correctAnswer.length && 
                                userAnswer.every(ans => correctAnswer.includes(ans));
                
                if (isCorrect) {
                    correctAnswers++;
                }

                resultDetails.push({
                    question: question.number,
                    text: question.text,
                    userAnswer: userAnswer,
                    correctAnswer: correctAnswer,
                    isCorrect: isCorrect
                });
            });

            const percentage = Math.round((correctAnswers / totalQuestions) * 100);
            
            displayResults(correctAnswers, totalQuestions, percentage, resultDetails);
        }

        // Display quiz results
        function displayResults(correct, total, percentage, details) {
            const resultsDiv = document.getElementById('results');
            
            let detailsHTML = '';
            details.forEach(detail => {
                const statusColor = detail.isCorrect ? '#2ecc71' : '#e74c3c';
                const statusIcon = detail.isCorrect ? '‚úÖ' : '‚ùå';
                
                detailsHTML += `
                    <div style="margin-bottom: 15px; padding: 10px; border-left: 4px solid ${statusColor}; background: rgba(255,255,255,0.5);">
                        <div style="font-weight: bold;">${statusIcon} Fr√•ga ${detail.question}</div>
                        <div style="font-size: 0.9em; color: #666;">Ditt svar: ${detail.userAnswer.join(', ') || 'Ej besvarat'}</div>
                        <div style="font-size: 0.9em; color: #666;">R√§tt svar: ${detail.correctAnswer.join(', ')}</div>
                    </div>
                `;
            });

            resultsDiv.innerHTML = `
                <div class="score">üìä Resultat: ${correct}/${total} (${percentage}%)</div>
                <div style="margin-bottom: 20px;">
                    ${percentage >= 80 ? 'üéâ Utm√§rkt! Du har god koll p√• nyheterna!' : 
                      percentage >= 60 ? 'üëç Bra jobbat! Du f√∂ljer nyheterna v√§l.' : 
                      'üìö Forts√§tt f√∂lja nyheterna f√∂r att f√∂rb√§ttra dina kunskaper.'}
                </div>
                ${detailsHTML}
            `;
            
            resultsDiv.classList.add('show');
        }

        // Reset quiz
        function resetQuiz() {
            userAnswers = {};
            transcriptMatches = [];
            document.getElementById('results').classList.remove('show');
            document.getElementById('transcriptMatches').innerHTML = '';
            
            // Reset all input fields
            document.querySelectorAll('input[type="radio"], input[type="checkbox"]').forEach(input => {
                input.checked = false;
            });

            // Remove answered styling
            document.querySelectorAll('.question').forEach(q => {
                q.classList.remove('answered');
            });

            updateProgress();
            updateStats();
        }

        // Load new quiz from file
        function loadNewQuiz(input) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const newQuiz = JSON.parse(e.target.result);
                    if (Array.isArray(newQuiz) && newQuiz.length > 0) {
                        currentQuiz = newQuiz;
                        resetQuiz();
                        renderQuiz();
                        updateStats();
                        alert(`‚úÖ Nytt quiz laddat! ${newQuiz.length} fr√•gor.`);
                    } else {
                        throw new Error('Invalid quiz format');
                    }
                } catch (error) {
                    alert('‚ùå Kunde inte ladda quiz-filen. Kontrollera att det √§r en giltig JSON-fil.');
                    console.error('Quiz loading error:', error);
                }
            };
            reader.readAsText(file);
        }

        // Analyze transcript for matches
        function analyzeTranscript() {
            const transcript = document.getElementById('transcriptArea').value.toLowerCase();
            if (!transcript.trim()) {
                alert('‚ö†Ô∏è Klistra in transkriptet f√∂rst!');
                return;
            }

            transcriptMatches = [];
            
            currentQuiz.forEach(question => {
                const matches = [];
                
                // Extract keywords from question and options
                const allText = question.text + ' ' + Object.values(question.options).join(' ');
                const keywords = extractKeywords(allText);
                
                // Search for matches in transcript
                keywords.forEach(keyword => {
                    const regex = new RegExp(`[^.!?]*${keyword}[^.!?]*[.!?]`, 'gi');
                    const sentenceMatches = transcript.match(regex);
                    if (sentenceMatches) {
                        matches.push(...sentenceMatches.map(match => match.trim()));
                    }
                });

                transcriptMatches.push({
                    question: question.number,
                    text: question.text,
                    matches: [...new Set(matches)].slice(0, 3) // Remove duplicates and limit
                });
            });

            displayTranscriptMatches();
        }

        // Extract meaningful keywords from text
        function extractKeywords(text) {
            const stopWords = new Set(['att', 'och', '√§r', 'det', 'en', 'f√∂r', 'till', 'med', 'som', 'av', 'p√•', 'om', 'har', 'inte', 'eller', 'kan', 'ska', 'man', 'fr√•n', 'vid', 's√•', 'men', 'nu', 'h√§r', 'd√§r', 'n√§r', 'hur', 'vad', 'var', 'i', 'a', 'an', 'the', 'and', 'or', 'but', 'in', 'on', 'at', 'to', 'for', 'of', 'with', 'by']);
            
            const words = text.toLowerCase()
                .replace(/[^\w\s√•√§√∂√Ö√Ñ√ñ]/g, ' ')
                .split(/\s+/)
                .filter(word => word.length > 3 && !stopWords.has(word));
                
            return [...new Set(words)].slice(0, 10); // Top 10 unique keywords
        }

        // Display transcript matches
        function displayTranscriptMatches() {
            const container = document.getElementById('transcriptMatches');
            
            let html = '<h3 style="margin-bottom: 20px; color: #2c3e50;">üîç Transkriptanalys</h3>';
            
            transcriptMatches.forEach(match => {
                html += `<div class="match-result">`;
                html += `<div class="match-question">Fr√•ga ${match.question}: ${match.text.substring(0, 100)}${match.text.length > 100 ? '...' : ''}</div>`;
                
                if (match.matches.length > 0) {
                    match.matches.forEach(sentence => {
                        html += `<div class="match-text">"${sentence}"</div>`;
                    });
                } else {
                    html += `<div class="no-matches">Inga matchningar hittades i transkriptet</div>`;
                }
                
                html += `</div>`;
            });
            
            container.innerHTML = html;
        }

        // Highlight matches in transcript
        function highlightMatches() {
            const transcriptArea = document.getElementById('transcriptArea');
            let transcript = transcriptArea.value;
            
            if (!transcript.trim()) {
                alert('‚ö†Ô∏è Klistra in transkriptet f√∂rst!');
                return;
            }

            // Collect all keywords from quiz
            const allKeywords = [];
            currentQuiz.forEach(question => {
                const keywords = extractKeywords(question.text + ' ' + Object.values(question.options).join(' '));
                allKeywords.push(...keywords);
            });

            // Remove duplicates and sort by length (longest first to avoid partial matches)
            const uniqueKeywords = [...new Set(allKeywords)].sort((a, b) => b.length - a.length);

            // Highlight keywords in transcript
            let highlightedTranscript = transcript;
            uniqueKeywords.forEach(keyword => {
                const regex = new RegExp(`\\b${keyword}\\b`, 'gi');
                highlightedTranscript = highlightedTranscript.replace(regex, `<span class="highlighted-match">${keyword}</span>`);
            });

            // Create a temporary div to show highlighted version
            const highlightDiv = document.createElement('div');
            highlightDiv.innerHTML = `
                <h4>üìù Markerade nyckelord i transkript:</h4>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; max-height: 300px; overflow-y: auto; font-family: monospace; line-height: 1.6;">
                    ${highlightedTranscript}
                </div>
                <p style="margin-top: 10px; font-size: 0.9em; color: #666;">
                    <span class="highlighted-match" style="display: inline;">Gula markeringar</span> visar nyckelord fr√•n quiz-fr√•gorna.
                </p>
            `;
            
            // Insert after transcript area
            const existingHighlight = document.querySelector('.highlight-container');
            if (existingHighlight) {
                existingHighlight.remove();
            }
            
            highlightDiv.className = 'highlight-container';
            highlightDiv.style.marginTop = '20px';
            transcriptArea.parentNode.insertBefore(highlightDiv, transcriptArea.nextSibling);
        }

        // Clear transcript and highlights
        function clearTranscript() {
            document.getElementById('transcriptArea').value = '';
            document.getElementById('transcriptMatches').innerHTML = '';
            
            const existingHighlight = document.querySelector('.highlight-container');
            if (existingHighlight) {
                existingHighlight.remove();
            }
            
            transcriptMatches = [];
        }

        // Export results as JSON
        function exportResults() {
            const transcript = document.getElementById('transcriptArea').value;
            const results = {
                timestamp: new Date().toISOString(),
                quiz: currentQuiz.map(q => ({
                    number: q.number,
                    text: q.text,
                    userAnswer: userAnswers[q.number] || [],
                    correctAnswer: q.correct,
                    isCorrect: userAnswers[q.number] && 
                              userAnswers[q.number].length === q.correct.length &&
                              userAnswers[q.number].every(ans => q.correct.includes(ans))
                })),
                transcript: transcript,
                matches: transcriptMatches,
                summary: {
                    totalQuestions: currentQuiz.length,
                    answeredQuestions: Object.keys(userAnswers).filter(q => userAnswers[q].length > 0).length,
                    correctAnswers: currentQuiz.filter(q => {
                        const userAnswer = userAnswers[q.number] || [];
                        return userAnswer.length === q.correct.length && 
                               userAnswer.every(ans => q.correct.includes(ans));
                    }).length
                }
            };

            const blob = new Blob([JSON.stringify(results, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `nyhetskoll-resultat-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Add export functionality to controls
        function addExportButton() {
            const controls = document.querySelector('.quiz-section .controls');
            const exportBtn = document.createElement('button');
            exportBtn.className = 'btn';
            exportBtn.innerHTML = 'üíæ Exportera Resultat';
            exportBtn.onclick = exportResults;
            exportBtn.style.background = 'linear-gradient(45deg, #e67e22, #d35400)';
            exportBtn.style.boxShadow = '0 4px 15px rgba(230, 126, 34, 0.3)';
            controls.appendChild(exportBtn);
        }

        // Initialize app when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            addExportButton();
            
            // Add some sample transcript for testing
            const sampleButton = document.createElement('button');
            sampleButton.className = 'btn';
            sampleButton.innerHTML = 'üìã Ladda Exempeltranskript';
            sampleButton.onclick = function() {
                const sampleTranscript = `V√§lkommen till Nyhetskoll. Idag pratar vi om viktiga h√§ndelser fr√•n veckan. 

En h√∂gerdebatt√∂r sk√∂ts till d√∂ds f√∂rra veckan i USA. Charlie Kirk var en k√§nd person inom konservativa kretsar. Detta v√§cker fr√•gor om v√•ld i politiska sammanhang och vapenlagarna i USA.

Vapenlagarna i USA regleras av det andra till√§gget i konstitutionen, grundlagen. The Second Amendment √§r en del av Bill of Rights som fastst√§ller amerikanska medborgarers r√§tt att b√§ra vapen.

En ny brasiliansk studie har unders√∂kt s√∂tningsmedel och deras effekt p√• hj√§rnan. Studien visar att s√∂tningsmedel kan f√∂rs√§mra hj√§rnans f√∂rm√•ga att ta emot och bearbeta information. Livsmedelsverket s√§ger d√§remot att fler studier beh√∂vs och att man inte beh√∂ver vara orolig f√∂r tillf√§llet.

Regeringen har f√∂reslagit att polisen ska f√• anv√§nda hemliga tv√•ngsmedel mot barn under 15 √•r. Exempel p√• hemliga tv√•ngsmedel inkluderar avlyssning och kamera√∂vervakning, men inte fotboja som √§r ett √∂ppet tv√•ngsmedel.

Barn och unga kan nu f√• bidrag genom fritidskortet f√∂r aktiviteter inom kultur och idrott. Bidraget √§r p√• 500 kronor per √•r.

En rapport fr√•n CAN, Centralf√∂rbundet f√∂r alkohol- och narkotikaupplysning, visar att f√§rre unga knarkar j√§mf√∂rt med tidigare √•r. Detta √§r positiva nyheter f√∂r folkh√§lsan.

P√• s√∂ndag √§r det kyrkoval. F√∂r att r√∂sta kr√§vs att man √§r medlem i Svenska kyrkan, folkbokf√∂rd i Sverige och har fyllt 16 √•r senast p√• valdagen. Man beh√∂ver inte vara svensk medborgare eller myndig.

FN har publicerat en rapport som anklagar Israel f√∂r att beg√• folkmord i Gaza. Enligt FN:s folkmordskonvention inneb√§r folkmord att minst en av fem handlingar beg√•s med avsikt att helt eller delvis f√∂rg√∂ra en grupp. Tv√• av handlingarna som n√§mns √§r att d√∂da medlemmar av gruppen och att skapa levnadsf√∂rh√•llanden som g√∂r att personer d√∂r.

Spanien, Irland, Nederl√§nderna, Slovenien och Island har sagt att de inte kommer att delta i Eurovision Song Contest 2026 om Israel till√•ts delta i t√§vlingen.

I Haiti har det skett attacker mot civila d√§r √∂ver 50 personer d√∂dades under veckan. Situationen i landet forts√§tter att vara mycket allvarlig.

Inom idrotten har stavhopparen Armand Duplantis slagit v√§rldsrekord f√∂r 14:e g√•ngen. Han hoppade 6.30 meter vilket √§r en fantastisk prestation.

Det var allt f√∂r denna vecka. Vi h√∂rs n√§sta fredag igen.`;
                
                document.getElementById('transcriptArea').value = sampleTranscript;
                alert('üìã Exempeltranskript laddat! Nu kan du testa analysefunktionerna.');
            };
            
            const transcriptControls = document.querySelector('.transcript-section .controls');
            transcriptControls.appendChild(sampleButton);
        });
    </script>
</body>
</html>
</pre>  
</body>
</html>
